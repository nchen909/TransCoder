{"repo": "moodle/moodle", "path": "backup/util/helper/convert_helper.class.php", "func_name": "convert_helper.detect_moodle2_format", "original_string": "public static function detect_moodle2_format($tempdir) {\n        $dirpath = make_backup_temp_directory($tempdir, false);\n        if (!is_dir($dirpath)) {\n            throw new convert_helper_exception('tmp_backup_directory_not_found', $dirpath);\n        }\n\n        $filepath = $dirpath . '/moodle_backup.xml';\n        if (!file_exists($filepath)) {\n            return false;\n        }\n\n        $handle     = fopen($filepath, 'r');\n        $firstchars = fread($handle, 200);\n        $status     = fclose($handle);\n\n        if (strpos($firstchars,'<?xml version=\"1.0\" encoding=\"UTF-8\"?>') !== false and\n            strpos($firstchars,'<moodle_backup>') !== false and\n            strpos($firstchars,'<information>') !== false) {\n                return true;\n        }\n\n        return false;\n    }", "language": "php", "code": "public static function detect_moodle2_format($tempdir) {\n        $dirpath = make_backup_temp_directory($tempdir, false);\n        if (!is_dir($dirpath)) {\n            throw new convert_helper_exception('tmp_backup_directory_not_found', $dirpath);\n        }\n\n        $filepath = $dirpath . '/moodle_backup.xml';\n        if (!file_exists($filepath)) {\n            return false;\n        }\n\n        $handle     = fopen($filepath, 'r');\n        $firstchars = fread($handle, 200);\n        $status     = fclose($handle);\n\n        if (strpos($firstchars,'<?xml version=\"1.0\" encoding=\"UTF-8\"?>') !== false and\n            strpos($firstchars,'<moodle_backup>') !== false and\n            strpos($firstchars,'<information>') !== false) {\n                return true;\n        }\n\n        return false;\n    }", "code_tokens": ["public", "static", "function", "detect_moodle2_format", "(", "$", "tempdir", ")", "{", "$", "dirpath", "=", "make_backup_temp_directory", "(", "$", "tempdir", ",", "false", ")", ";", "if", "(", "!", "is_dir", "(", "$", "dirpath", ")", ")", "{", "throw", "new", "convert_helper_exception", "(", "'tmp_backup_directory_not_found'", ",", "$", "dirpath", ")", ";", "}", "$", "filepath", "=", "$", "dirpath", ".", "'/moodle_backup.xml'", ";", "if", "(", "!", "file_exists", "(", "$", "filepath", ")", ")", "{", "return", "false", ";", "}", "$", "handle", "=", "fopen", "(", "$", "filepath", ",", "'r'", ")", ";", "$", "firstchars", "=", "fread", "(", "$", "handle", ",", "200", ")", ";", "$", "status", "=", "fclose", "(", "$", "handle", ")", ";", "if", "(", "strpos", "(", "$", "firstchars", ",", "'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'", ")", "!==", "false", "and", "strpos", "(", "$", "firstchars", ",", "'<moodle_backup>'", ")", "!==", "false", "and", "strpos", "(", "$", "firstchars", ",", "'<information>'", ")", "!==", "false", ")", "{", "return", "true", ";", "}", "return", "false", ";", "}"], "docstring": "Detects if the given folder contains an unpacked moodle2 backup\n\n@param string $tempdir the name of the backup directory\n@return boolean true if moodle2 format detected, false otherwise", "docstring_tokens": ["Detects", "if", "the", "given", "folder", "contains", "an", "unpacked", "moodle2", "backup"], "sha": "a411b499b98afc9901c24a9466c7e322946a04aa", "url": "https://github.com/moodle/moodle/blob/a411b499b98afc9901c24a9466c7e322946a04aa/backup/util/helper/convert_helper.class.php#L133-L155", "partition": "train"}

